<html lang="pl">
<head>
  <link rel="manifest" href="data:application/manifest+json;base64,eyJuYW1lIjoiIiwic2hvcnRfbmFtZSI6IiIsInRoZW1lX2NvbG9yIjoiIzEwMTMxNyIsImJhY2tncm91bmRfY29sb3IiOiIjMTAxMzE3IiwiZGlzcGxheSI6InN0YW5kYWxvbmUifQ==">
  <title>mObywatel</title>
  <meta charset="UTF-8">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="format-detection" content="telephone=no">
  <meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="assets/app/main.css">
  <link rel="stylesheet" href="assets/app/card.css">
  <link rel="icon" type="image/x-icon" href="assets/app/images/ikonka.png">
  <link rel="apple-touch-icon" href="assets/app/images/ikonka.png">
  <link rel="shortcut icon" href="assets/app/images/ikonka.png">
</head>
<body>

  <div class="top_grid_fixed">
    <div class="action_grid_fixed">
      <img src="assets/app/images/back_blue.png" class="back_img_fixed" alt="">
      <p onclick="sendTo('documents.html')" class="back_text_fixed">Dokumenty</p>
    </div>
    <p class="title_text_fixed">mDowód</p>
    <img src="assets/app/images/help.png" class="help_img_fixed" alt="">
  </div>

  <div class="bottom_bar">
    <div class="bottom_bar_grid">
      <div class="bottom_element_grid" send="documents.html">
        <div class="bottom_element_image documents_open"></div>
        <p class="bottom_element_text open">Dokumenty</p>
      </div>
      <div class="bottom_element_grid" send="services.html">
        <div class="bottom_element_image services"></div>
        <p class="bottom_element_text">Usługi</p>
      </div>
      <div class="bottom_element_grid" send="qr.html">
        <div class="bottom_element_image qr"></div>
        <p class="bottom_element_text">Kod QR</p>
      </div>
      <div class="bottom_element_grid" send="more.html">
        <div class="bottom_element_image more"></div>
        <p class="bottom_element_text">Więcej</p>
      </div>
    </div>
  </div>

  <div class="container">
    <p class="time_text" id="time">Czas: 01:28:22 27.10.2025</p>

    <div class="id_wrapper">
      <div class="id_image_data">
        <img draggable="false" class="id_image" src="assets/app/images/idCardBackground.png" alt="">
        <img draggable="false" class="id_image_effect" src="assets/app/images/idCardEffect.png" alt="">
        <div class="inset"></div>

        <div class="id_own_image" id="userPhoto" style="background-image:url('assets/app/images/blank.png');"></div>

        <img draggable="false" src="assets/app/images/flag.webp" class="flag_video" alt="">
        <img draggable="false" src="assets/app/images/eagle.gif" class="eagle_video" alt="">
        <p class="eagle_text">Rzeczpospolita<br>Polska</p>

        <div class="id_data_grid">
          <div class="data_holder">
            <p class="data_title firstname" id="name"></p>
            <p class="data_value">Imię (imiona)</p>
          </div>
          <div class="data_holder">
            <p class="data_title surname" id="surname"></p>
            <p class="data_value">Nazwisko</p>
          </div>
          <div class="data_holder">
            <p class="data_title" id="nationality"></p>
            <p class="data_value">Obywatelstwo</p>
          </div>
          <div class="data_holder">
            <p class="data_title" id="birthday"></p>
            <p class="data_value">Data urodzenia</p>
          </div>
          <div class="data_holder">
            <p class="data_title" id="pesel_value"></p>
            <p class="data_value">Numer PESEL</p>
          </div>
        </div>
      </div>

      <div class="id_bottom">
        <div class="bottom_grid" style="position:relative;top:1px;">
          <img class="bottom_image" src="assets/app/images/checkamrk new and perfect reworked.png" alt="">
          <p class="bottom_text" style="color:#49e570;font-weight:450;font-size:13px;margin-left:5px;position:relative;top:-1.5px;">Dokument ważny</p>
        </div>
      </div>
    </div>

    <div class="under_container">
      <div class="under_grid">
        <div class="under_icon" onclick="sendTo('scan.html', 'card.html')">
          <div class="under_image_circle">
            <img class="under_image" src="assets/app/images/confirm.png" alt="">
          </div>
          <p class="under_text">Potwierdź swoje dane</p>
        </div>
        <div class="under_icon" onclick="sendTo('document.html')">
          <div class="under_image_circle">
            <img class="under_image" src="assets/app/images/IB025_Dane_dowoduosobistego_card_mini@3x.png" alt="">
          </div>
          <p class="under_text">Dane dowodu osobistego</p>
        </div>
        <div class="under_icon" onclick="sendTo('pesel.html')">
          <div class="under_image_circle">
            <img class="under_image under_image_blue under_image_larger" src="assets/app/images/AC004_Lock_pesel@3x.png" alt="">
          </div>
          <p class="under_text">Zastrzeż PESEL</p>
        </div>
        <div class="under_icon" onclick="sendTo('shortcuts.html')">
          <div class="under_image_circle">
            <img class="under_image under_image_small under_image_blue" src="assets/app/images/more.png" alt="">
          </div>
          <p class="under_text">Pozostałe skróty</p>
        </div>
      </div>
    </div>

    <div class="confirm_info">
      <div class="confirm_box">
        <p class="box_top">Seria i numer mDowodu</p>
        <p class="box_value box_highlight" id="seriesAndNumber"></p>
        <button class="main_button_filled" onclick="navigator.clipboard.writeText(document.getElementById('seriesAndNumber').textContent)">Kopiuj</button>
        <p class="box_description">Dane mDowodu i dowodu osobistego są inne - to dwa różne dokumenty.</p>
      </div>
      <div class="confirm_box">
        <p class="box_top">Termin ważności mDowodu</p>
        <p class="box_value" id="expiryDate"></p>
      </div>
      <div class="confirm_box">
        <p class="box_top">Data wydania mDowodu</p>
        <p class="box_value" id="givenDate"></p>
      </div>
      <div class="confirm_box">
        <p class="box_top">Imię ojca</p>
        <p class="box_value" id="fathersName"></p>
      </div>
      <div class="confirm_box" style="border:none;">
        <p class="box_top">Imię matki</p>
        <p class="box_value" id="mothersName"></p>
      </div>
    </div>

    <div class="other_grid">
      <div class="bottom_holder info_holder">
        <div class="bottom_grid">
          <p class="bottom_text" style="margin-left:0px;">Twoje dodatkowe dane</p>
        </div>
  <img class="action_arrow" src="assets/app/images/right_arrow_sharp.png" alt="">
        <div class="additional_holder">
          <div class="additional_grid">
            <p class="additional_title">Nazwisko rodowe</p>
            <p class="additional_subtitle" id="familyName"></p>
          </div>
          <div class="additional_grid">
            <p class="additional_title">Płeć</p>
            <p class="additional_subtitle" id="sex"></p>
          </div>
          <div class="additional_grid">
            <p class="additional_title">Nazwisko rodowe ojca</p>
            <p class="additional_subtitle" id="fathersFamilyName"></p>
          </div>
          <div class="additional_grid">
            <p class="additional_title">Nazwisko rodowe matki</p>
            <p class="additional_subtitle" id="mothersFamilyName"></p>
          </div>
          <div class="additional_grid">
            <p class="additional_title">Miejsce urodzenia</p>
            <p class="additional_subtitle" id="birthPlace"></p>
          </div>
        </div>
      </div>

      <div class="bottom_holder" style="height:95px;margin-bottom:130px;">
        <div class="bottom_update">
          <div class="bottom_update_grid">
            <p class="bottom_update_text" style="margin-left:0px;">Ostatnia aktualizacja</p>
            <p class="bottom_update_value" id="updateDate" style="margin-left:0px;"></p>
          </div>
          <button class="main_button_filled update" style="right:20px;" onclick="location.reload()">Aktualizuj</button>
        </div>
      </div>
    </div>
  </div>

  <script src="assets/app/encode.js"></script>
  <script src="assets/app/bar.js"></script>
  <script src="assets/app/card.js"></script>
  <script src="assets/app/manifest.js"></script>
  <script src="assets/app/cache.js"></script>

  <script>
    // === Wczytywanie danych z localStorage lub URL ===
    const fields = [
      'name','surname','nationality','birthday','pesel_value','seriesAndNumber','expiryDate',
      'givenDate','fathersName','mothersName','familyName','sex','fathersFamilyName',
      'mothersFamilyName','birthPlace','updateDate'
    ];
    
    // Mapowanie ID elementów do kluczy localStorage
    const storageKeyMap = {
      'pesel_value': 'pesel',
      'seriesAndNumber': 'seriesAndNumber',
      'expiryDate': 'expiryDate',
      'givenDate': 'givenDate'
    };
    
    const params = new URLSearchParams(window.location.search);
    fields.forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      
      // Użyj mappingu jeśli istnieje, inaczej użyj ID
      const storageKey = storageKeyMap[id] || id;
      let value = params.get(id) || localStorage.getItem(storageKey);
      if (value) el.textContent = value;
    });
    // Sprawdź zdjęcie z URL lub localStorage
    const photoUrl = params.get('image');
    const photo = photoUrl || localStorage.getItem('userPhoto');
    if (photo) document.getElementById('userPhoto').style.backgroundImage = `url(${photo})`;
  </script>

  <!-- Hard Refresh Button -->
  <button onclick="location.reload(true)" style="
    position: fixed;
    bottom: 90px;
    right: 15px;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: #014A93;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 999;
    display: flex;
    align-items: center;
    justify-content: center;
  ">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
      <path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
    </svg>
  </button>
</body>
</html>
